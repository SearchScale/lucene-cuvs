"""Build file for raft."""

load(
    "@lucene-cuvs//thirdparty:global_defs.bzl",
    "LUCENE_CUVS_GLOBAL_COMPILE_FLAGS",
    "LUCENE_CUVS_GLOBAL_DEFINES",
    "LUCENE_CUVS_OFFLOAD_SM89",
)
load("@rules_ll//ll:defs.bzl", "ll_library")

exports_files(["cpp/scripts/__clang_cuda_additional_intrinsics.h"])

ll_library(
    name = "raft",
    compile_flags = LUCENE_CUVS_GLOBAL_COMPILE_FLAGS + LUCENE_CUVS_OFFLOAD_SM89 + ["-fopenmp"],
    compilation_mode = "cuda_nvptx_nvcc",
    experimental_device_intrinsics = [
        "cpp/scripts/__clang_cuda_additional_intrinsics.h",
    ],
    angled_includes = [
        "cpp/include",
    ],
    includes = [
        "cpp/src/neighbors/detail/cagra",
        "cpp/src/raft_runtime/distance",
    ],
    defines = LUCENE_CUVS_GLOBAL_DEFINES,
    exposed_hdrs = glob(["cpp/include/**/*"]),
    exposed_angled_includes = ["cpp/include"],
    hdrs = glob(["cpp/src/include/**/*"]) + [
        "cpp/src/raft_runtime/cluster/cluster_cost.cuh",
        "cpp/src/raft_runtime/cluster/update_centroids.cuh",
        "cpp/src/neighbors/detail/cagra/search_single_cta.cuh",
        "cpp/src/neighbors/detail/cagra/search_multi_cta.cuh",
        "cpp/src/raft_runtime/distance/fused_distance_min_arg.hpp",

        # TODO(aaronmondal): Including this header named "common.cuh` is risky
        #                    because there is another one with the same name in
        #                    raft. We might want to change this upstream to
        #                    avoid accidentally including the wrong header. For
        #                    now it seems to work.
        "cpp/src/raft_runtime/random/common.cuh",
    ],
    visibility = ["//visibility:public"],
    deps = [
        "@rmm",
        "@fmt",
        "@spdlog",
        "@cutlass",
        "@cutlass//:cute",
        "@cccl//:cub",
        "@cccl//:thrust",
        "@cccl//:libcudacxx",
        "@llvm-project//openmp",
    ],
    # TODO(aaronmondal): Upstream fixes until everything we need compiles.
    srcs = [
        # "cpp/src/core/logger.cpp",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_canberra_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_canberra_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_correlation_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_correlation_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_cosine_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_cosine_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_hamming_unexpanded_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_hamming_unexpanded_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_hellinger_expanded_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_hellinger_expanded_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_jensen_shannon_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_jensen_shannon_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_kl_divergence_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_kl_divergence_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l1_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l1_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l2_expanded_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l2_expanded_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l2_unexpanded_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l2_unexpanded_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l_inf_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_l_inf_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_lp_unexpanded_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_lp_unexpanded_float_float_float_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_rbf.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_russel_rao_double_double_double_int.cu",
        # "cpp/src/distance/detail/pairwise_matrix/dispatch_russel_rao_float_float_float_int.cu",
        # "cpp/src/distance/distance.cu",
        # "cpp/src/distance/fused_l2_nn.cu",
        # "cpp/src/distance/fused_distance_nn.cu",
        # "cpp/src/linalg/detail/coalesced_reduction.cu",
        # "cpp/src/matrix/detail/select_k_double_int64_t.cu",
        # "cpp/src/matrix/detail/select_k_double_uint32_t.cu",
        # "cpp/src/matrix/detail/select_k_float_int64_t.cu",
        # "cpp/src/matrix/detail/select_k_float_uint32_t.cu",
        # "cpp/src/matrix/detail/select_k_float_int32.cu",
        # "cpp/src/matrix/detail/select_k_half_int64_t.cu",
        # "cpp/src/matrix/detail/select_k_half_uint32_t.cu",
        # "cpp/src/neighbors/ball_cover.cu",
        # "cpp/src/neighbors/brute_force_fused_l2_knn_float_int64_t.cu",
        # "cpp/src/neighbors/brute_force_knn_int64_t_float_int64_t.cu",
        # "cpp/src/neighbors/brute_force_knn_int64_t_float_uint32_t.cu",
        # "cpp/src/neighbors/brute_force_knn_int_float_int.cu",
        # "cpp/src/neighbors/brute_force_knn_uint32_t_float_uint32_t.cu",
        # "cpp/src/neighbors/brute_force_knn_index_float.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_float_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_float_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_float_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_float_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_half_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_half_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_half_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_half_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_int8_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_int8_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_int8_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_int8_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_uint8_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_uint8_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_uint8_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_multi_cta_uint8_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_float_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_float_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_float_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_float_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_half_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_half_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_half_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_half_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_int8_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_int8_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_int8_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_int8_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_uint8_uint32_dim128_t8.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_uint8_uint32_dim256_t16.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_uint8_uint32_dim512_t32.cu",
        # "cpp/src/neighbors/detail/cagra/search_single_cta_uint8_uint32_dim1024_t32.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_int8_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_uint8_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_float_uint64_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_multi_cta_half_uint64_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_int8_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_uint8_uint32_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_float_uint64_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim128_t8_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim128_t8_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim256_t16_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim256_t16_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim512_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim512_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim1024_t32_8pq_2subd_half.cu",
        # "cpp/src/neighbors/detail/cagra/q_search_single_cta_half_uint64_dim1024_t32_8pq_4subd_half.cu",
        # "cpp/src/neighbors/detail/ivf_flat_interleaved_scan_float_float_int64_t.cu",
        # "cpp/src/neighbors/detail/ivf_flat_interleaved_scan_half_half_int64_t.cu",
        # "cpp/src/neighbors/detail/ivf_flat_interleaved_scan_int8_t_int32_t_int64_t.cu",
        # "cpp/src/neighbors/detail/ivf_flat_interleaved_scan_uint8_t_uint32_t_int64_t.cu",
        # "cpp/src/neighbors/detail/ivf_flat_search.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_float_float.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_float_fp8_false.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_float_fp8_true.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_float_half.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_half_fp8_false.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_half_fp8_true.cu",
        # "cpp/src/neighbors/detail/ivf_pq_compute_similarity_half_half.cu",
        # "cpp/src/neighbors/detail/refine_host_float_float.cpp",
        # "cpp/src/neighbors/detail/refine_host_half_float.cpp",
        # "cpp/src/neighbors/detail/refine_host_int8_t_float.cpp",
        # "cpp/src/neighbors/detail/refine_host_uint8_t_float.cpp",
        # "cpp/src/neighbors/ivf_flat_build_float_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_build_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_build_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_extend_float_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_extend_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_extend_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_search_float_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_search_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivf_flat_search_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_build_float_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_build_half_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_build_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_build_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_extend_float_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_extend_half_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_extend_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_extend_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_search_float_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_search_half_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_search_int8_t_int64_t.cu",
        # "cpp/src/neighbors/ivfpq_search_uint8_t_int64_t.cu",
        # "cpp/src/neighbors/refine_float_float.cu",
        # "cpp/src/neighbors/refine_half_float.cu",
        # "cpp/src/neighbors/refine_int8_t_float.cu",
        # "cpp/src/neighbors/refine_uint8_t_float.cu",
        # "cpp/src/raft_runtime/cluster/cluster_cost_double.cu",
        # "cpp/src/raft_runtime/cluster/cluster_cost_float.cu",
        # "cpp/src/raft_runtime/cluster/kmeans_fit_double.cu",
        # "cpp/src/raft_runtime/cluster/kmeans_fit_float.cu",
        # "cpp/src/raft_runtime/cluster/kmeans_init_plus_plus_double.cu",
        # "cpp/src/raft_runtime/cluster/kmeans_init_plus_plus_float.cu",
        # "cpp/src/raft_runtime/cluster/update_centroids_double.cu",
        # "cpp/src/raft_runtime/cluster/update_centroids_float.cu",
        # "cpp/src/raft_runtime/distance/fused_distance_min_arg.cu",
        # "cpp/src/raft_runtime/distance/fused_l2_min_arg.cu",
        # "cpp/src/raft_runtime/distance/pairwise_distance.cu",
        # "cpp/src/raft_runtime/matrix/select_k_float_int64_t.cu",
        # "cpp/src/raft_runtime/neighbors/brute_force_knn_int64_t_float.cu",

        # TODO(aaronmondal): These are the ones we're actually interested in.
        "cpp/src/raft_runtime/neighbors/cagra_build.cu",
        "cpp/src/raft_runtime/neighbors/cagra_search.cu",
        "cpp/src/raft_runtime/neighbors/cagra_serialize.cu",

        # "cpp/src/raft_runtime/neighbors/eps_neighborhood.cu",
        # #cpp/ "$<$<BOOL:${BUILD_CAGRA_HNSWLIB}>:src/raft_runtime/neighbors/hnsw.cpp>",
        # "cpp/src/raft_runtime/neighbors/ivf_flat_build.cu",
        # "cpp/src/raft_runtime/neighbors/ivf_flat_search.cu",
        # "cpp/src/raft_runtime/neighbors/ivf_flat_serialize.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_build.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_deserialize.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_search_float_int64_t.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_search_int8_t_int64_t.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_search_uint8_t_int64_t.cu",
        # "cpp/src/raft_runtime/neighbors/ivfpq_serialize.cu",
        # "cpp/src/raft_runtime/neighbors/refine_d_int64_t_float.cu",
        # "cpp/src/raft_runtime/neighbors/refine_d_int64_t_int8_t.cu",
        # "cpp/src/raft_runtime/neighbors/refine_d_int64_t_uint8_t.cu",
        # "cpp/src/raft_runtime/neighbors/refine_h_int64_t_float.cu",
        # "cpp/src/raft_runtime/neighbors/refine_h_int64_t_int8_t.cu",
        # "cpp/src/raft_runtime/neighbors/refine_h_int64_t_uint8_t.cu",
        # "cpp/src/raft_runtime/random/rmat_rectangular_generator_int64_double.cu",
        # "cpp/src/raft_runtime/random/rmat_rectangular_generator_int64_float.cu",
        # "cpp/src/raft_runtime/random/rmat_rectangular_generator_int_double.cu",
        # "cpp/src/raft_runtime/random/rmat_rectangular_generator_int_float.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_eps_pass_euclidean.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_2d_dist.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_2d_euclidean.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_2d_haversine.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_3d_dist.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_3d_euclidean.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_one_3d_haversine.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_2d_dist.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_2d_euclidean.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_2d_haversine.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_3d_dist.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_3d_euclidean.cu",
        # "cpp/src/spatial/knn/detail/ball_cover/registers_pass_two_3d_haversine.cu",
        # "cpp/src/spatial/knn/detail/fused_l2_knn_int32_t_float.cu",
        # "cpp/src/spatial/knn/detail/fused_l2_knn_int64_t_float.cu",
        # "cpp/src/spatial/knn/detail/fused_l2_knn_uint32_t_float.cu",
    ],
)
